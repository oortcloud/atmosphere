<head>
  <title>Atmosphere | Beer. Wings. Smart Packages.</title>
  <link href='//fonts.googleapis.com/css?family=Arvo' rel='stylesheet' type='text/css'>
  <link href='//fonts.googleapis.com/css?family=PT+Sans' rel='stylesheet' type='text/css'>
</head>

<body>
  <div class="pull-right">{{> loginButtons}}</div>
  <div class="container">
    <h1 class="pull-left"><a href="/">Atmosphere</a></h1>
    <div class="subtitle" style="clear: both">
      <em>Beer. Wings. Smart Packages.</em>
    </div>
    <div class="content">
      {{> content}}
    </div>
  </div>
</body>

<template name="content">
  <ul class="nav nav-tabs nav-main">
    <li class="{{isActiveTop "wtf"}} pull-right"><a href="wtf/app">WTF¿</a></li>
    <li class="{{isActiveTop "packages"}} pull-right"><a href="">Packages</a></li>
  </ul>
  <div class="tab-content">
    <div class="tab-pane active">
      {{{render currentPage}}}
    </div>
  </div>
  <div id="modal-backdrop" class="modal-backdrop {{modalHidden}}"></div>
</template>

<template name="dump">
  {{#each packages}}
    <pre>{{dump}}</pre>
  {{/each}}
</template>

<template name="packages">
  {{#if packagesLoading}}
    <p>
      <i class="icon-refresh"></i>
      doing something smart...
    </p>
  {{else}}
    {{#ifAny packages}}
      <table class="packages table-striped">
        <thead>
          <tr>
            <th>Name</th>
            <th>Description</th>
            <th>Current</th>
            <th>Updated</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          {{#each packages}}
          <tr>
            <td><a href="{{homepage}}">{{name}}</a></td>
            <td>{{trunc description}}</td>
            <td>v{{latest}}</td>
            <td>
              {{refreshEvery "15s"}}
              <span class="timeAgo">{{timeAgo}}</span>
            </td>
            <td class="info-cell">
              <a class="btn btn-mini details"><i class="icon-info-sign"></i> Info</a>
              
              <div class="modal {{detailsModalClass}}">
                <div class="modal-header">
                  <button type="button" class="close">×</button>
                  <h3>Package Info</h3>
                </div>
                <div class="modal-body">
                  {{> package}}
                </div>
              </div>
              
            </td>
          </tr>
          {{/each}}
        </tbody>
      </table>
    {{else}}
      <p>add some packages. or don't.</p>
    {{/ifAny}}
  {{/if}}
</template>

<template name="meteoriteCallout">
  <p class="alert alert-info">
    Atmosphere's smart packages are installed and managed by the Meteorite command line tool. Visit <a href="http://possibilities.github.com/meteorite">Meteorite's home page</a> to learn more.
  </p>
</template>

<template name="package">
  <dl>
    <dt><p>Name</p></dt>
    <dd><p><a href="{{homepage}}">{{name}}</a></p></dd>
    <dt><p>Description</p></dt>
    <dd><p>{{description}}</p></dd>
    <dt><p>Author</p></dt>
    <dd>
      <p>
        {{#if author/url}}<a href="{{author/url}}">{{/if}}
          {{author/name}}
        {{#if author/url}}</a>{{/if}}
      </p>
    </dd>
    <dt><p>Current version</p></dt>
    <dd><p>v{{latest}}</p></dd>
    <dt><p>Available versions</p></dt>
    <dd>
      {{#each versions}}
        <p>v{{version}}</p>
      {{/each}}
    </dd>
    {{#if nonStandardMeteor}}
      <dd>Note: This package relies on a non standard version of meteor. Be careful!</dd>
    {{/if}}
  </dl>
</template>

<head>
  <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-34025267-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

  </script>
</head>
